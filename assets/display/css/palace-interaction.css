/* ========================================
   Ziwei Palace Interaction Styles
   ======================================== */

/* ========================================
   1. Palace Selection & Highlight States
   ======================================== */


.ziwei-cal[data-ziwei-mode="chart"] .ziwei-cell-selected {
    background: #f3e6ff;
    border-color: #9b59b6;
    box-shadow: inset 0 0 0 2px #9b59b6;
}

.ziwei-cal[data-ziwei-mode="chart"] .ziwei-cell-selected:hover {
    background: #f3e6ff !important;
}

.ziwei-cal[data-ziwei-mode="chart"] .ziwei-cell-highlighted {
    background: #e8f4f8;
    border-color: #3498db;
    box-shadow: inset 0 0 0 1px #3498db;
}

.ziwei-cal[data-ziwei-mode="chart"] .ziwei-cell-highlighted:hover {
    background: #e8f4f8 !important;
}

/* ========================================
   2. Connection Lines
   ======================================== */

.ziwei-connection-lines {
    display: block;
}

/* SVG canvas for drawing connection lines between palaces */
.ziwei-connection-lines svg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1;
}

/* Connection line stroke styles */
.ziwei-connection-line {
    stroke: #3498db;
    stroke-width: 2px;
    opacity: 0.6;
    fill: none;
}

/* Relationship indicator line (e.g., 三方四正) */
.ziwei-relationship-line {
    stroke: #9b59b6;
    stroke-width: 2px;
    opacity: 0.5;
    fill: none;
}

/* Hover state for connection lines */
.ziwei-cell-highlighted .ziwei-connection-line {
    opacity: 1;
    stroke-width: 3px;
}

/* ========================================
   3. Palace Cell Base Interaction
   ======================================== */

.ziwei-cal[data-ziwei-mode="chart"] .ziwei-cell {
    cursor: pointer;
}

.ziwei-cal[data-ziwei-mode="chart"] .ziwei-cell:hover {
    background: #f0f0f0;
}

/* ========================================
   4. Relationship Indicator
   ======================================== */

.ziwei-relationship-indicator {
    position: absolute;
    top: 2px;
    right: 2px;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 8px;
    font-weight: 700;
    color: #ffffff;
    background: transparent;
    border: 1px solid #3498db;
}

.ziwei-relationship-indicator.related-ming {
    background: #3498db;
    border-color: #2980b9;
}

.ziwei-relationship-indicator.related-shen {
    background: #9b59b6;
    border-color: #8e44ad;
}

.ziwei-relationship-indicator.related-three-four {
    background: #e74c3c;
    border-color: #c0392b;
}

/* ========================================
   5. Interactive Effects
   ======================================== */

/* Active state during interaction */
.ziwei-cell.active {
    position: relative;
    z-index: 10;
}

/* Related palace visual link */
.ziwei-palace-link {
    position: absolute;
    width: 100%;
    height: 100%;
    border: 2px dashed rgba(52, 152, 219, 0.3);
    border-radius: 0;
    pointer-events: none;
}

/* ========================================
   6. Tooltip Styles (If needed)
   ======================================== */

.ziwei-palace-tooltip {
    position: absolute;
    background: #2c3e50;
    color: #ffffff;
    padding: 8px 12px;
    border-radius: 4px;
    font-size: 14px;
    z-index: 100;
    pointer-events: none;
    white-space: nowrap;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

.ziwei-palace-tooltip::after {
    content: '';
    position: absolute;
    width: 0;
    height: 0;
    border-left: 4px solid transparent;
    border-right: 4px solid transparent;
    border-top: 4px solid #2c3e50;
}

/* ========================================
   7. Animation States
   ======================================== */

@keyframes palace-pulse {
    0% {
        box-shadow: inset 0 0 0 2px #3498db;
    }
    50% {
        box-shadow: inset 0 0 0 4px #3498db;
    }
    100% {
        box-shadow: inset 0 0 0 2px #3498db;
    }
}

.ziwei-cell.pulsing {
    animation: palace-pulse 0.6s ease-in-out;
}

@keyframes line-draw {
    from {
        stroke-dasharray: 100;
        stroke-dashoffset: 100;
    }
    to {
        stroke-dasharray: 100;
        stroke-dashoffset: 0;
    }
}

.ziwei-connection-lines svg line.drawing {
    animation: line-draw 0.5s ease-out forwards;
}

/* ========================================
   8. Accessibility
   ======================================== */

.ziwei-cell:focus {
    outline: 2px solid #3498db;
    outline-offset: -2px;
}

/* ========================================
   Utility Styles
   ======================================== */

.hidden {
    display: none !important;
}

/* No interaction state */
.ziwei-cell.disabled {
    opacity: 0.5;
    cursor: not-allowed;
    pointer-events: none;
}
